<div *ngIf="dataLoaded && castSelected"
    class="drop-group-container"
    cdkDropListGroup>
  <div class="position-pool">
    <div
        *ngIf="buttonsEnabled"
        class="name-export-container">
      <input
          type="text"
          class="name-input"
          (input)="onTitleInput($event)"
          [value]="this.cast.name"
          [size]="this.cast.name.length < 15 ? 15 : this.cast.name.length" />
      <button
          mat-icon-button
          aria-label="Export Cast Button"
          class="export-button"
          (click)="exportCast()">
        <mat-icon [inline]="true" class="export-button-icon">
          save_alt
        </mat-icon>
      </button>
    </div>
    <div *ngFor="let position of castPositions; let px = index"
        class="position-container">
      <div class="table-container">
        <div
            class="horizontal-list"
            id="col-headers">
          <div class="cell cellBothHeader">
            <div class="double-header-cell">
              <div class="double-header-text">
                {{ castPositions[px].pos.name }}
              </div>
              <div class="double-header-buttons">
                <div class="button-v-wrapper">
                  <div class="button-v-container">
                    <button mat-icon-button
                        aria-label="Decrement Dancer Count Button"
                        class="count-button1"
                        [disabled]="position.dancerCount < 2"
                        (click)="decrementDancerCount(px)">
                      <mat-icon [inline]="true"
                          class="count-icon1">
                        remove_circle_outline
                      </mat-icon>
                    </button>
                    <button mat-icon-button
                        aria-label="Increment Dancer Count Button"
                        class="count-button2"
                        (click)="incrementDancerCount(px)">
                      <mat-icon [inline]="true"
                          class="count-icon2">
                        add_circle_outline
                      </mat-icon>
                    </button>
                  </div>
                </div>  
              </div>
            </div>  
          </div>
          <div *ngFor="let header of subCastHeaders; let hx = index"
              class="cell cellColHeader"
              [class.adjust-last-cast-cell]="hx === subCastHeaders.length - 1">
            <ng-container  *ngIf="hx < subCastHeaders.length - 1; else lastCast">
                {{ header }}
            </ng-container>
            <ng-template #lastCast>
              <div class="last-cast-cell">
                <div class="last-cast-text">
                  {{ header }}
                </div>
                <div class="button-h-wrapper">
                  <div class="button-h-container">
                    <button mat-icon-button
                        aria-label="Decrement Dancer Count Button"
                        class="count-button1"
                        [disabled]="subCastHeaders.length < 2"
                        (click)="decrementCastCount()">
                      <mat-icon [inline]="true"
                          class="count-icon1">
                        remove_circle_outline
                      </mat-icon>
                    </button>
                    <button mat-icon-button
                        aria-label="Increment Dancer Count Button"
                        class="count-button2"
                        (click)="incrementCastCount()">
                      <mat-icon [inline]="true"
                          class="count-icon2">
                        add_circle_outline
                      </mat-icon>
                    </button>
                  </div>  
                </div>
              </div>
            </ng-template> 
          </div>
        </div>
        <div *ngFor="let row of position.castRows; let cx = index"
            cdkDropList
            cdkDropListOrientation="horizontal"
            class="horizontal-list"
            [cdkDropListData]="row"
            (cdkDropListDropped)="drop($event)"
            [id]="px+ ':' + cx">
          <div class="cell cellRowHeader">
            {{ "Dancer" + (position.dancerCount > 1 ? " #" + (cx + 1) : "") }}
          </div>
          <div *ngFor="let dancer of position.castRows[cx].subCastDancers; let dx = index"
              class="cell"
              cdkDrag
              [cdkDragData]="dancer"
              [ngStyle]="dx == boldedCast ? {'font-weight' : 'bold'} : {}">
            <div *ngIf="dancer!==undefined">
              <img
                  class="user-image"
                  [src]="baseImageUrl + dancer.firstName + '_' + dancer.lastName + '.jpg' | lowercase">
              {{dancer.firstName + " " + dancer.lastName}}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="user-container">
    <div class="horizontal-list user-pool"
        cdkDropList
        cdkDropListOrientation="horizontal"
        [cdkDropListData]="allUsers"
        (cdkDropListDropped)="drop($event)"
        id="user-pool">
      <div *ngFor="let user of allUsers"
          class="cell user-cell"
          cdkDrag
          [cdkDragData]="user">
        <img
            class="user-image"
            [src]="baseImageUrl + user.first_name + '_' + user.last_name + '.jpg' | lowercase">
        {{user.first_name + " " + user.last_name}}
      </div>
    </div>
    <div *ngIf="buttonsEnabled"
        class="buttons-container">
      <button mat-icon-button
          class="save-delete-button"
          (click)="deleteCast()">
        <mat-icon class="save-delete-button-icon">
          delete
        </mat-icon>
      </button>
      <button mat-icon-button
          class="save-delete-button"
          (click)="saveCast()">
        <mat-icon class="save-delete-button-icon">
          save
        </mat-icon>
      </button>
    </div>
  </div>
</div>
